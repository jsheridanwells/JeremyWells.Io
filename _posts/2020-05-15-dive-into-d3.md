---
layout: post
title: A Dive Into D3
draft: true
standfirst: 'If you are interested in original ways of presenting particularly large, unique, or complex data sets, then a dive into D3 is certainly worth the effort.'
---

[D3](#), or Data-Driven Documents, is still a top choice for data visualization in the browser. Part of its power is that it isn't merely a charts library, but rather a way to add and manipulate DOM elements in response to data.

[As](#) [these](#) [examples](#) [show](#), this provides limitless possibilities for original ways to illustrate with data as well as creative coding.

However, all of that power comes with a steep learning curve, and D3 requires some investment for it to become a reliable tool. If your use case is only to add standard data charts to a front-end application, [Chart.Js](#) (as well as several commercial products) can be a much friendlier solution. But if you are interested in original ways of presenting particularly large, unique, or complex data sets, then a dive into D3 is certainly worth the effort.

This tutorial will serve as a simple jumping off point. We will build a simple SPA that illustrates the forecast for a location over the next five days with a line chart. While not a particularly exciting result, my intent is to show some of the very basic concepts with the way D3 manipulates the DOM. This can serve as a jumping off point for exploring further with this tool, and for understanding the code in the [numerous D3 examples](#) that are out there.

### 0. Prerequisites

This tutorial is designed for any beginner or advanced front-end developer without any familiarity with D3. I'll walk through some basic steps for creating a line graph with data from the [OpenWeatherMap](#) API and describe what we're tasking D3 to do in each step. This tutorial assumes familiarity with basic front-end concepts like javascript functions, AJAX calls, and using jQuery to make selecting DOM elements easier. To set up and run the boilerplate code, you'll need at least a little familiarity with Github and running a local HTTP server (installing [http-server](https://www.npmjs.com/package/http-server) globally is an easy option). 

### 1. Tour of the Boilerplate

The [Dive-Into-D3](#) Github repo has got some boilerplate files to get us started. The `master` branch contains our starting point. If you want to just see the result, you can switch to the `final` branch. Either clone the repo (`$ git clone #`) or download and unpack the zip. Run your HTTP server from the project's root directory (`$ http-server -o` if you're using http-server). 

Navigating the project's `index.html` file (`http://localhost:8080` for me), we can see a very basic nav bar that lets a user enter a US zip code (I've hard coded [60606](https://en.wikipedia.org/wiki/Willis_Tower)) and below will be a space to show a weather chart when that gets done. If you click the submit button, you'll see an error below saying "ReferenceError: api is not defined". 

-- IMAGE HERE -- 

If this is what you're seeing, then the boilerplate code is working on your machine as expected. In the next step, we'll register for an [OpenWeatherMap](#) api key and make the error go away.

Here is what we have so far:
 - `index.html` is a basic Bootstrap starter page with a navbar called `#nav` for entering a location, and a viewport called `#chart` for displaying the result.
 - `ajax.js` contains a function called `getWeather` that retrieves data from the OpenWeatherMap api. If you don't want to go through with registering and setting up the api, there is a commented out version of the same function that just pulls some sample data from a local json file. If you want to skip step 2, you can comment out the first `getWeather` and uncomment the second one, and everything should still work.
 - `line-chart.js` contains a function called `drawChart`. This is the function we'll be adding to in order to create our line chart in the steps below.
 - `main.js` is what gets controlled from the DOM. There is a jQuery listener that calls our `getWeather` function and then calls `drawChart` to render the data. There is also a helper function called `sortTimeTemps` that processes the OpenWeatherMap json result so it's easier to work with in the D3 functions.
 - `main.css` contains any styles we'll need. I wont' go into how D3 leverages CSS to render data, but you can certainly play with the appearance of the line chart from here on your own.

You can safely ignore any of the contents above except `line-chart-.js` for this tutorial.


### 2. Getting an OpenWeatherMap API Key

When I'm trying out a new tool using data from an external API, the [OpenWeatherMap](#) api is an easy way to get clear example data. Walk through their sign up process, then you can generate your own API key at [this url](https://home.openweathermap.org/api_keys).

With your api key, we'll do a quick and dirty command to create an api key file that will be ignored in source control, but threaded into the rest of the javascript functions:
```bash
$ echo 'export const apiKey = "<YOUR OPEN WEATHER MAP API KEY>";' >> javascripts/apiKey.js
```

Now if you see a new javascripts file called `apiKey.js` with the following contents, you should be ready:
```javascript
export const apiKey = "<YOUR OPEN WEATHER MAP API KEY>";
```

Refresh your application and if everything is sucessful, it should call out to the OpenWeatherMap API, and you'll see different cities in the result box when you enter different US zip codes. Likewise, if you open up the console, you should see a response from the OpenWeatherMap api.


-- IMAGE HERE -- 


Note that this is not a great way to protect an api key in an app in production, but for now this we'll keep the key out of source control.

-- IMAGE HERE -- 

### 3. Setting up an SVG

A common HTML element type for working with 
